<svg width="4108" height="2043" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" overflow="hidden"><defs><clipPath id="clip0"><rect x="86" y="125" width="4108" height="2043"/></clipPath></defs><g clip-path="url(#clip0)" transform="translate(-86 -125)"><path d="M558.5 790.875C558.5 804.337 671.548 815.251 811 815.251 950.452 815.251 1063.5 804.337 1063.5 790.875L1063.5 937.125C1063.5 950.587 950.452 961.5 811 961.5 671.548 961.5 558.5 950.587 558.5 937.125Z" fill="#C4B6D9" fill-rule="evenodd"/><path d="M558.5 790.875C558.5 777.413 671.548 766.5 811 766.5 950.452 766.5 1063.5 777.413 1063.5 790.875 1063.5 804.337 950.452 815.251 811 815.251 671.548 815.251 558.5 804.337 558.5 790.875Z" fill="#DCD3E8" fill-rule="evenodd"/><path d="M1063.5 790.875C1063.5 804.337 950.452 815.251 811 815.251 671.548 815.251 558.5 804.337 558.5 790.875 558.5 777.413 671.548 766.5 811 766.5 950.452 766.5 1063.5 777.413 1063.5 790.875L1063.5 937.125C1063.5 950.587 950.452 961.5 811 961.5 671.548 961.5 558.5 950.587 558.5 937.125L558.5 790.875" stroke="#000000" stroke-width="4.58333" stroke-linejoin="round" stroke-miterlimit="10" fill="none" fill-rule="evenodd"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="73" transform="matrix(1 0 0 1 653.64 902)">KVServer</text><rect x="558.5" y="1140.5" width="505" height="133" stroke="#000000" stroke-width="4.58333" stroke-linejoin="round" stroke-miterlimit="10" fill="#F5E4A9"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="83" transform="matrix(1 0 0 1 592.625 1236)">Raft<tspan font-size="83" x="151.25" y="0">-</tspan>Leader</text><rect x="558.5" y="1452.5" width="505" height="133" stroke="#000000" stroke-width="4.58333" stroke-linejoin="round" stroke-miterlimit="10" fill="#CCD8E7"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="83" transform="matrix(1 0 0 1 647.624 1548)">Persister</text><path d="M27.5-3.4375 85.9379-3.4375 85.9379 658.367 27.5004 658.367 27.5004 651.492 82.5004 651.492 79.0629 654.929 79.0629 0 82.5004 3.4375 27.5 3.4375ZM27.5 0 45.8333 22.9167 0 0 45.8333-22.9167ZM27.5004 654.929 45.8337 677.846 0.000360892 654.929 45.8337 632.013Z" transform="matrix(-1 1.22465e-16 1.22465e-16 1 558.5 864.5)"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="64" transform="matrix(1 0 0 1 124.667 1125)">1. <tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="71.0417" y="0">检测</tspan><tspan font-size="64" x="199.375" y="0">Raft</tspan><tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="0" y="77">日志长度</tspan></text><path d="M813.938 961.5 813.938 1112.82 807.063 1112.82 807.063 961.5ZM810.5 1112.82 833.417 1094.49 810.5 1140.32 787.584 1094.49Z"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="64" transform="matrix(1 0 0 1 888.097 1060)">2. <tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="71.0417" y="0">拍摄快照</tspan></text><path d="M3.4375-6.93741e-06 3.43781 151.323-3.43719 151.323-3.4375 6.93741e-06ZM0.000305393 151.323 22.9169 132.99 0.000360892 178.823-22.9164 132.99Z" transform="matrix(-1 0 0 1 810.5 1273.5)"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="64" transform="matrix(1 0 0 1 888.097 1343)">3. <tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="71.0417" y="0">更新</tspan>Raft<tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="316.823" y="0">状态并</tspan><tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="0" y="77">持久化已提交日志</tspan></text><path d="M92.5 792.504C92.5 685.911 178.911 599.5 285.504 599.5L1249.5 599.5C1356.09 599.5 1442.5 685.911 1442.5 792.504L1442.5 1564.5C1442.5 1671.09 1356.09 1757.5 1249.5 1757.5L285.504 1757.5C178.911 1757.5 92.5 1671.09 92.5 1564.5Z" stroke="#000000" stroke-width="6.875" stroke-miterlimit="8" stroke-dasharray="27.5 20.625 6.875 20.625" fill="none" fill-rule="evenodd"/><path d="M2644.5 212.875C2644.5 226.337 2770.31 237.25 2925.5 237.25 3080.69 237.25 3206.5 226.337 3206.5 212.875L3206.5 359.125C3206.5 372.587 3080.69 383.5 2925.5 383.5 2770.31 383.5 2644.5 372.587 2644.5 359.125Z" fill="#C4B6D9" fill-rule="evenodd"/><path d="M2644.5 212.875C2644.5 199.413 2770.31 188.5 2925.5 188.5 3080.69 188.5 3206.5 199.413 3206.5 212.875 3206.5 226.337 3080.69 237.25 2925.5 237.25 2770.31 237.25 2644.5 226.337 2644.5 212.875Z" fill="#DCD3E8" fill-rule="evenodd"/><path d="M3206.5 212.875C3206.5 226.337 3080.69 237.25 2925.5 237.25 2770.31 237.25 2644.5 226.337 2644.5 212.875 2644.5 199.413 2770.31 188.5 2925.5 188.5 3080.69 188.5 3206.5 199.413 3206.5 212.875L3206.5 359.125C3206.5 372.587 3080.69 383.5 2925.5 383.5 2770.31 383.5 2644.5 372.587 2644.5 359.125L2644.5 212.875" stroke="#000000" stroke-width="4.58333" stroke-linejoin="round" stroke-miterlimit="10" fill="none" fill-rule="evenodd"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="73" transform="matrix(1 0 0 1 2768.55 325)">KVServer</text><rect x="2644.5" y="562.5" width="562" height="133" stroke="#000000" stroke-width="4.58333" stroke-linejoin="round" stroke-miterlimit="10" fill="#F5E4A9"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="83" transform="matrix(1 0 0 1 2680.03 658)">Raft<tspan font-size="83" x="151.25" y="0">-</tspan>Follower</text><rect x="2644.5" y="874.5" width="562" height="133" stroke="#000000" stroke-width="4.58333" stroke-linejoin="round" stroke-miterlimit="10" fill="#CCD8E7"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="83" transform="matrix(1 0 0 1 2762.53 970)">Persister</text><path d="M2644.5 1297.88C2644.5 1311.34 2770.31 1322.25 2925.5 1322.25 3080.69 1322.25 3206.5 1311.34 3206.5 1297.88L3206.5 1444.13C3206.5 1457.59 3080.69 1468.5 2925.5 1468.5 2770.31 1468.5 2644.5 1457.59 2644.5 1444.13Z" fill="#C4B6D9" fill-rule="evenodd"/><path d="M2644.5 1297.88C2644.5 1284.41 2770.31 1273.5 2925.5 1273.5 3080.69 1273.5 3206.5 1284.41 3206.5 1297.88 3206.5 1311.34 3080.69 1322.25 2925.5 1322.25 2770.31 1322.25 2644.5 1311.34 2644.5 1297.88Z" fill="#DCD3E8" fill-rule="evenodd"/><path d="M3206.5 1297.88C3206.5 1311.34 3080.69 1322.25 2925.5 1322.25 2770.31 1322.25 2644.5 1311.34 2644.5 1297.88 2644.5 1284.41 2770.31 1273.5 2925.5 1273.5 3080.69 1273.5 3206.5 1284.41 3206.5 1297.88L3206.5 1444.13C3206.5 1457.59 3080.69 1468.5 2925.5 1468.5 2770.31 1468.5 2644.5 1457.59 2644.5 1444.13L2644.5 1297.88" stroke="#000000" stroke-width="4.58333" stroke-linejoin="round" stroke-miterlimit="10" fill="none" fill-rule="evenodd"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="73" transform="matrix(1 0 0 1 2768.55 1409)">KVServer</text><rect x="2644.5" y="1646.5" width="562" height="134" stroke="#000000" stroke-width="4.58333" stroke-linejoin="round" stroke-miterlimit="10" fill="#F5E4A9"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="83" transform="matrix(1 0 0 1 2680.03 1743)">Raft<tspan font-size="83" x="151.25" y="0">-</tspan>Follower</text><rect x="2644.5" y="1959.5" width="562" height="133" stroke="#000000" stroke-width="4.58333" stroke-linejoin="round" stroke-miterlimit="10" fill="#CCD8E7"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="83" transform="matrix(1 0 0 1 2762.53 2055)">Persister<tspan font-size="64" x="-1253.32" y="-940">4.</tspan><tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="-1182.28" y="-940">从</tspan><tspan font-size="64" x="-1118.11" y="-940">AppendEntries</tspan><tspan font-size="64" x="-680.405" y="-940">RPC</tspan><tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="-1253.32" y="-863">切换到</tspan><tspan font-size="64" x="-1060.82" y="-863">InstallSnapshot</tspan><tspan font-size="64" x="-605.353" y="-863">RPC</tspan></text><path d="M0-3.4375 1294.35-3.4375 1294.35 577.854 1290.91 574.417 1553.9 574.417 1553.9 581.292 1287.48 581.292 1287.48 0 1290.91 3.4375 0 3.4375ZM1553.9 577.854 1535.57 554.938 1581.4 577.854 1535.57 600.771Z" transform="matrix(1 0 0 -1 1063.5 1207.35)"/><path d="M1063.5 1203.06 2357.85 1203.06 2357.85 1713.24 2354.41 1709.8 2617.4 1709.8 2617.4 1716.68 2350.98 1716.68 2350.98 1206.5 2354.41 1209.94 1063.5 1209.94ZM2617.4 1713.24 2599.07 1690.32 2644.9 1713.24 2599.07 1736.16Z"/><path d="M2922.06 562.323 2922.06 411 2928.94 411 2928.94 562.323ZM2925.5 411 2902.58 429.334 2925.5 383.5 2948.42 429.333Z"/><path d="M3.4375-6.93741e-06 3.43781 151.323-3.43719 151.323-3.4375 6.93741e-06ZM0.000305393 151.323 22.9169 132.99 0.000360892 178.823-22.9164 132.99Z" transform="matrix(-1 0 0 1 2925.5 695.5)"/><path d="M3.4375-6.93741e-06 3.43781 151.323-3.43719 151.323-3.4375 6.93741e-06ZM0.000305393 151.323 22.9169 132.99 0.000360892 178.823-22.9164 132.99Z" transform="matrix(-1 0 0 1 2925.5 1780.5)"/><path d="M3.4375-6.93741e-06 3.43781 151.323-3.43719 151.323-3.4375 6.93741e-06ZM0.000305393 151.323 22.9169 132.99 0.000360892 178.823-22.9164 132.99Z" transform="matrix(1 0 0 -1 2925.5 1647.32)"/><path d="M2595.5 1333C2595.5 1271.97 2644.97 1222.5 2706 1222.5L3148 1222.5C3209.03 1222.5 3258.5 1271.97 3258.5 1333L3258.5 2054C3258.5 2115.03 3209.03 2164.5 3148 2164.5L2706 2164.5C2644.97 2164.5 2595.5 2115.03 2595.5 2054Z" stroke="#000000" stroke-width="6.875" stroke-miterlimit="8" stroke-dasharray="27.5 20.625 6.875 20.625" fill="none" fill-rule="evenodd"/><path d="M2594.5 239.002C2594.5 177.973 2643.97 128.5 2705 128.5L3147 128.5C3208.03 128.5 3257.5 177.973 3257.5 239.002L3257.5 959.998C3257.5 1021.03 3208.03 1070.5 3147 1070.5L2705 1070.5C2643.97 1070.5 2594.5 1021.03 2594.5 959.998Z" stroke="#000000" stroke-width="6.875" stroke-miterlimit="8" stroke-dasharray="27.5 20.625 6.875 20.625" fill="none" fill-rule="evenodd"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="64" transform="matrix(1 0 0 1 1919.93 426)">7.<tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="71.0418" y="0">将原始字节发</tspan><tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="0" y="77">送到</tspan><tspan font-size="64" x="128.333" y="77">KVServer</tspan><tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="0" y="154">并重置数据库</tspan></text><path d="M2409.5 480.5 2925.29 486.384" stroke="#000000" stroke-width="6.875" stroke-miterlimit="8" stroke-dasharray="27.5 20.625" fill="none" fill-rule="evenodd"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="64" transform="matrix(1 0 0 1 3430.89 575)">5. <tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="71.0415" y="0">比较</tspan><tspan font-size="64" x="199.375" y="0">LastIncludedIndex</tspan><tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="0" y="77">和</tspan><tspan font-size="64" x="64.1665" y="77">LastIncludedTerm</tspan><tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="568.677" y="77">并保</tspan><tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="0" y="154">留后面的日志</tspan></text><path d="M3206.5 629.5 3398.18 629.5" stroke="#000000" stroke-width="6.875" stroke-miterlimit="8" stroke-dasharray="27.5 20.625" fill="none" fill-rule="evenodd"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="64" transform="matrix(1 0 0 1 3430.89 926)">6.<tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="53.2813" y="0">更新快照状态</tspan><tspan font-family="SimHei,SimHei_MSFontService,sans-serif" font-size="64" x="0" y="77">并保留快照数据</tspan></text><path d="M3206.5 941.5 3398.18 941.5" stroke="#000000" stroke-width="6.875" stroke-miterlimit="8" stroke-dasharray="27.5 20.625" fill="none" fill-rule="evenodd"/></g></svg>